<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="å‰è¨€æœ€è¿‘æœ‰ä¸ªæƒ³æ³•ï¼Œå¸Œæœ›åœ¨ä¸€ä¸ª yarn workspace é¡¹ç›®ä¸­å®ç°ä»»æ„ä¸€ä¸ªå­åŒ…ä¸­å®‰è£…ä¾èµ–æ—¶ï¼Œéƒ½æ‰§è¡Œä¸€äº›ç±»ä¼¼äºåˆå§‹åŒ–ã€åŒæ­¥é…ç½®çš„åŠ¨ä½œã€‚ ç„¶è€Œåœ¨æ“ä½œè¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€ä¸ªå…³äº yarn --cwd æœ‰è¶£çš„é—®é¢˜ï¼Œç‰¹åœ°è®°å½•ä¸‹æ¥ï¼Œå¸Œæœ›èƒ½å¯¹åæ¥è€…æœ‰æ‰€å¸®åŠ©ã€‚ é‡åˆ°ä»€ä¹ˆé—®é¢˜å‘¢å…ˆäº¤ä»£ä¸€ä¸‹æˆ‘ä»¬é¡¹ç›®çš„åŸºæœ¬æƒ…å†µï¼Œå®ƒæ˜¯ä¸€ä¸ªé€šè¿‡ yarn workspace ç®¡ç†çš„ monorepo é¡¹ç›®ï¼Œä½¿ç”¨çš„æ˜¯ yarn v1.22.11">
<meta property="og:type" content="article">
<meta property="og:title" content="ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·">
<meta property="og:url" content="https://4ark.me/post/yarn-cwd-issue.html">
<meta property="og:site_name" content="4Ark Ã— Blog">
<meta property="og:description" content="å‰è¨€æœ€è¿‘æœ‰ä¸ªæƒ³æ³•ï¼Œå¸Œæœ›åœ¨ä¸€ä¸ª yarn workspace é¡¹ç›®ä¸­å®ç°ä»»æ„ä¸€ä¸ªå­åŒ…ä¸­å®‰è£…ä¾èµ–æ—¶ï¼Œéƒ½æ‰§è¡Œä¸€äº›ç±»ä¼¼äºåˆå§‹åŒ–ã€åŒæ­¥é…ç½®çš„åŠ¨ä½œã€‚ ç„¶è€Œåœ¨æ“ä½œè¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€ä¸ªå…³äº yarn --cwd æœ‰è¶£çš„é—®é¢˜ï¼Œç‰¹åœ°è®°å½•ä¸‹æ¥ï¼Œå¸Œæœ›èƒ½å¯¹åæ¥è€…æœ‰æ‰€å¸®åŠ©ã€‚ é‡åˆ°ä»€ä¹ˆé—®é¢˜å‘¢å…ˆäº¤ä»£ä¸€ä¸‹æˆ‘ä»¬é¡¹ç›®çš„åŸºæœ¬æƒ…å†µï¼Œå®ƒæ˜¯ä¸€ä¸ªé€šè¿‡ yarn workspace ç®¡ç†çš„ monorepo é¡¹ç›®ï¼Œä½¿ç”¨çš„æ˜¯ yarn v1.22.11">
<meta property="og:locale">
<meta property="article:published_time" content="2022-07-23T00:00:00.000Z">
<meta property="article:modified_time" content="2024-02-06T18:11:56.000Z">
<meta property="article:author" content="4Ark">
<meta property="article:tag" content="å‰ç«¯">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <script>localStorage.getItem("dark_mode")==="dark"&&document.write(`<link rel="stylesheet" href="${location.origin}/css/dark.css">`)</script>
    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
    <meta name="google-site-verification" content="DwDg4EuywHWNZUkTC7sG0WGv_UQekM4uRtOoaGuDJHc" />
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="4Ark Ã— Blog" type="application/atom+xml">
<link rel="alternate" href="/rss.xml" title="4Ark Ã— Blog" type="application/rss+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about">About</a></li><!--
     --><!--
       --><li><a href="/archives">Writing</a></li><!--
     --><!--
       --><li><a href="/weekly">Weekly</a></li><!--
     --><!--
       --><li><a href="/tags">Tags</a></li><!--
     --><!--
       --><li><a href="/search">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/post/live-sentiment.html"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/post/weekly-14.html"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon"><i class="fa fa-moon" id="dark-btn" aria-hidden="true" onmouseover="$('#i-dark').toggle()" onmouseout="$('#i-dark').toggle()"></i></a></li>
        <li><a class="icon" target="_blank" rel="noopener" href="https://4ark.me/atom.xml" aria-label="rss"><i class="fas fa-rss"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-dark" class="info" style="display: none;">Switch mode</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://4ark.me/post/yarn-cwd-issue.html"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://4ark.me/post/yarn-cwd-issue.html&text=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://4ark.me/post/yarn-cwd-issue.html&title=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://4ark.me/post/yarn-cwd-issue.html&is_video=false&description=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·&body=Check out this article: https://4ark.me/post/yarn-cwd-issue.html"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://4ark.me/post/yarn-cwd-issue.html&title=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://4ark.me/post/yarn-cwd-issue.html&title=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://4ark.me/post/yarn-cwd-issue.html&title=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://4ark.me/post/yarn-cwd-issue.html&title=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://4ark.me/post/yarn-cwd-issue.html&name=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://4ark.me/post/yarn-cwd-issue.html&t=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%81%87%E5%88%B0%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98%E5%91%A2"><span class="toc-number">2.</span> <span class="toc-text">é‡åˆ°ä»€ä¹ˆé—®é¢˜å‘¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E5%8E%9F%E5%9B%A0"><span class="toc-number">3.</span> <span class="toc-text">åˆ†æåŸå› </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E6%BA%90%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text">åˆ†ææºç </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">5.</span> <span class="toc-text">è§£å†³æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AF%AD"><span class="toc-number">6.</span> <span class="toc-text">ç»“è¯­</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·
    </h1>



    <div class="meta">
      <span
        class="author"
        itemprop="author"
        itemscope
        itemtype="http://schema.org/Person"
      >
        <span itemprop="name"
          >4Ark</span
        >
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-07-23T00:00:00.000Z" itemprop="datePublished">2022-07-23</time>
        
      
    </div>

 
      
        
 
        
    <div class="article-tag">
        <i class="fas fa-hashtag"></i>
        <a class="tag-link-link" href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag">å‰ç«¯</a>
    </div>


      
    </div>
  </header>
  

  <div class="content" itemprop="articleBody"><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘æœ‰ä¸ªæƒ³æ³•ï¼Œå¸Œæœ›åœ¨ä¸€ä¸ª yarn workspace é¡¹ç›®ä¸­å®ç°ä»»æ„ä¸€ä¸ªå­åŒ…ä¸­å®‰è£…ä¾èµ–æ—¶ï¼Œéƒ½æ‰§è¡Œä¸€äº›ç±»ä¼¼äºåˆå§‹åŒ–ã€åŒæ­¥é…ç½®çš„åŠ¨ä½œã€‚</p>
<p>ç„¶è€Œåœ¨æ“ä½œè¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€ä¸ªå…³äº <code>yarn --cwd</code> æœ‰è¶£çš„é—®é¢˜ï¼Œç‰¹åœ°è®°å½•ä¸‹æ¥ï¼Œå¸Œæœ›èƒ½å¯¹åæ¥è€…æœ‰æ‰€å¸®åŠ©ã€‚</p>
<h2 id="é‡åˆ°ä»€ä¹ˆé—®é¢˜å‘¢"><a href="#é‡åˆ°ä»€ä¹ˆé—®é¢˜å‘¢" class="headerlink" title="é‡åˆ°ä»€ä¹ˆé—®é¢˜å‘¢"></a>é‡åˆ°ä»€ä¹ˆé—®é¢˜å‘¢</h2><p>å…ˆäº¤ä»£ä¸€ä¸‹æˆ‘ä»¬é¡¹ç›®çš„åŸºæœ¬æƒ…å†µï¼Œå®ƒæ˜¯ä¸€ä¸ªé€šè¿‡ yarn workspace ç®¡ç†çš„ monorepo é¡¹ç›®ï¼Œä½¿ç”¨çš„æ˜¯ yarn v1.22.11 ç‰ˆæœ¬ï¼Œç›®å½•ç»“æ„å¤§è‡´å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">monorepo</span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ app-a</span><br><span class="line">â”‚Â Â  â””â”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ app-b</span><br><span class="line">â”‚Â Â  â””â”€â”€ package.json</span><br><span class="line">â””â”€â”€ config</span><br><span class="line"> Â Â  â””â”€â”€ package.json</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ <code>app-a</code> å’Œ <code>app-b</code> éƒ½ä½¿ç”¨äº† <code>config</code> è¿™ä¸ªå…±äº«åŒ…ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;@monorepo/config&quot;</span>: <span class="string">&quot;../config&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬éœ€è¦åœ¨æ ¹ç›®å½•çš„ <code>package.json</code> ä¸­çš„ <code>preinstall</code> é’©å­åšä¸€äº›åˆå§‹åŒ–æ“ä½œï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;preinstall&quot;</span>: <span class="string">&quot;./bin/init.sh&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶æˆ‘ä»¬åœ¨æ ¹ç›®å½•æ‰§è¡Œ <code>yarn</code> æˆ–è€… <code>yarn add &lt;pkg-name&gt;</code>ï¼Œéƒ½ä¼šè§¦å‘ <code>preinstall</code> è¿™ä¸ªé’©å­ï¼Œä½†åœ¨ <code>app-a</code> ä¸­æ‰§è¡Œ <code>yarn</code>æ˜¯ä¸ä¼šè§¦å‘æ ¹ç›®å½•çš„ <code>preinstall</code> é’©å­çš„ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åˆ†åˆ«åœ¨æ¯ä¸ªå­åŒ…ä¸Šéƒ½åŠ ä¸Šè¿™è¡Œï¼Œä¹Ÿå³åœ¨æ¯ä¸ªå­åŒ…å®‰è£…ä¾èµ–æ—¶éƒ½æ‰§è¡Œä¸€ä¸‹æ ¹ç›®å½•çš„ <code>preinstall</code> å‘½ä»¤ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;preinstall&quot;</span>: <span class="string">&quot;yarn --cwd ../ preinstall&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>äºæ˜¯ï¼Œå¥‡æ€ªçš„äº‹æƒ…å°±å‘ç”Ÿäº†ï¼Œå½“æˆ‘åœ¨ <code>app-a</code> ä¸­æ‰§è¡Œ <code>yarn</code> çš„æ—¶å€™ï¼Œå®ƒåœç•™åœ¨å®‰è£… <code>@monorepo/config</code> çš„é˜¶æ®µï¼ŒåŒæ—¶æˆ‘çš„ç”µè„‘æ˜æ˜¾å˜å¾—å¡é¡¿ï¼Œäºæ˜¯æ‰“å¼€ <code>htop</code> ä¸€çœ‹ï¼Œå¥½å®¶ä¼™ï¼Œæ»¡å±éƒ½æ˜¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4ark   40987  26.3  0.5 409250368  78624   ??  R  8:36ä¸‹åˆ   0:00.09 /usr/<span class="built_in">local</span>/bin/node /usr/<span class="built_in">local</span>/bin/yarn --cwd ../ preinstall</span><br></pre></td></tr></table></figure>

<p>CPU å ç”¨ç‡ç›´æ¥è¾¾åˆ° 100%ï¼Œå“å¾—æˆ‘èµ¶ç´§ kill æ‰è¿™äº›è¿›ç¨‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep preinstall | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> | xargs <span class="built_in">kill</span> -9</span><br></pre></td></tr></table></figure>

<h2 id="åˆ†æåŸå› "><a href="#åˆ†æåŸå› " class="headerlink" title="åˆ†æåŸå› "></a>åˆ†æåŸå› </h2><p>æƒŠå“è¿‡åï¼Œæ¥åˆ†æä¸€ä¸‹åŸå› ï¼Œå¾ˆæ˜¾ç„¶è¿™æ®µå‘½ä»¤é™·å…¥äº†æ­»å¾ªç¯ï¼Œå¯¼è‡´è¶Šæ¥è¶Šå¤šè¿›ç¨‹ï¼Œäºæ˜¯å°è¯•åœ¨æ¯ä¸ªå­åŒ…ä¸­éƒ½æ‰‹åŠ¨æ‰§è¡Œä¸€é <code>yarn --cwd ../ preinstall</code> åï¼Œå‘ç°ä¸€åˆ‡æ­£å¸¸ï¼Œé‚£é—®é¢˜å‡ºåœ¨å“ªå‘¢ï¼Ÿ</p>
<p>äºæ˜¯æˆ‘å†æ‰§è¡Œäº†ä¸€é <code>yarn</code>ï¼Œå¹¶ä¸”ç”¨ä»¥ä¸‹å‘½ä»¤å°†è¿›ç¨‹ä¿¡æ¯å¤åˆ¶å‡ºæ¥ï¼Œä»¥ä¾¿åˆ†æï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | pbcopy</span><br></pre></td></tr></table></figure>

<p>éšåéªŒè¯æˆ‘åˆšåˆšçš„çŒœæµ‹ï¼Œçš„ç¡®æ˜¯è¿™ä¸ªå‘½ä»¤åœ¨ä¸æ–­è§¦å‘è‡ªå·±ï¼Œå¯¼è‡´æ­»å¾ªç¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UID   PID  PPID   C STIME   TTY     TIME CMD</span><br><span class="line">501 50399 50379   0  8:50ä¸‹åˆ ??   0:00.10 /usr/local/bin/node /usr/local/bin/yarn --cwd ../ preinstall</span><br><span class="line">501 50400 50399   0  8:50ä¸‹åˆ ??   0:00.11 /usr/local/bin/node /usr/local/bin/yarn --cwd ../ preinstall</span><br><span class="line">501 50401 50400   0  8:50ä¸‹åˆ ??   0:00.11 /usr/local/bin/node /usr/local/bin/yarn --cwd ../ preinstall</span><br><span class="line">501 50402 50401   0  8:50ä¸‹åˆ ??   0:00.12 /usr/local/bin/node /usr/local/bin/yarn --cwd ../ preinstall</span><br></pre></td></tr></table></figure>

<p>ç”±äºä¸‰ä¸ªåˆ†åŒ…æ‰§è¡Œçš„å‘½ä»¤éƒ½ä¸€æ ·ï¼Œä¸æ¸…æ¥šæ˜¯ä¸æ˜¯ç”±äºæŸä¸ªåˆ†åŒ…å¼•èµ·ï¼Œäºæ˜¯ä¿®æ”¹ä¸€ä¸‹å‘½ä»¤ä»¥ä¾¿åŒºåˆ†ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;preinstall&quot;</span>: <span class="string">&quot;echo app-a &amp;&amp; yarn --cwd ../ preinstall&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>éšåå‘ç°é—®é¢˜æ˜¯å‡ºç°åœ¨ <code>config</code> è¿™ä¸ªå­åŒ…ï¼Œäºæ˜¯æˆ‘æŠŠè¿™ä¸ªå­åŒ…çš„ <code>preinstall</code> å‘½ä»¤å»æ‰ï¼Œæœç„¶æ²¡æœ‰è¿™ä¸ªé—®é¢˜äº†ï¼Œéå¸¸å¥‡æ€ªã€‚</p>
<p>éš¾é“æ˜¯ <code>--cwd ../</code> è¿™ä¸ªè·¯å¾„æœ‰é—®é¢˜ï¼ŸéªŒè¯ä¸€ä¸‹ï¼ŒæŠŠå‘½ä»¤æ”¹æˆè¿™æ ·ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;preinstall&quot;</span>: <span class="string">&quot;pwd &amp;&amp; yarn --cwd ../ preinstall&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‘ç° <code>pwd</code> è¾“å‡ºæ˜¯è¿™æ ·å­çš„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/4ark/projects/monorepo/app-a/node_modules/@monorepo/config</span><br></pre></td></tr></table></figure>

<p>ä»è¿™é‡Œçš„è¾“å‡ºæˆ‘ä»¬å‘ç°äº†ä¸¤ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼š</p>
<ul>
<li>yarn workspace å…±äº«åŒ…çš„ <code>preinstall</code> è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œå…¶å®å·²ç»è¢«æ‹·è´åˆ° <code>app-a</code> çš„ <code>node_modules</code> ä¸­ï¼Œè€Œä¸æ˜¯åœ¨å½“å‰ç›®å½•ï¼Œå› æ­¤ <code>--cwd ../</code> å¹¶ä¸æŒ‡å‘é¡¹ç›®æ ¹ç›®å½•ã€‚</li>
</ul>
<p>è¿™ä¸€ç‚¹æ¯”è¾ƒå¥½ç†è§£ï¼Œæ¯•ç«Ÿ <code>config</code> ä½œä¸ºä¸€ä¸ªä¾èµ–åŒ…ï¼Œç¡®å®åº”è¯¥è¢«æ‹·è´åˆ°åº”ç”¨çš„ <code>node_modules</code> ã€‚</p>
<p>è€Œç¬¬äºŒä¸ªé—®é¢˜å°±ä¸å¤ªç†è§£äº†ï¼Œä¸ºä»€ä¹ˆæ˜æ˜è®¾ç½®äº† <code>--cwd ../</code>ï¼Œå´ä¾ç„¶åœ¨å½“å‰ç›®å½•æ‰§è¡Œå‘¢ï¼ŸæŒ‰ç…§é¢„æœŸ cwd çš„æŒ‡å‘åº”è¯¥æ˜¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/4ark/projects/monorepo/app-a/node_modules/@monorepo</span><br></pre></td></tr></table></figure>

<p>éš¾é“æ˜¯æˆ‘å¯¹ cwd å‚æ•°çš„ç†è§£æœ‰åå·®ï¼Ÿçœ‹ä¸€ä¸‹ yarn çš„æ–‡æ¡£ä¸­å¯¹ cwd æè¿°ï¼š</p>
<blockquote>
<p>Specifies a current working directory, instead of the default <code>./</code>. Use this flag to perform an operation in a working directory that is not the current one.</p>
<p>This can make scripts nicer by avoiding the need to <code>cd</code> into a folder and then <code>cd</code> back out.</p>
</blockquote>
<p>ä»æ–‡æ¡£çš„æè¿°æ¥çœ‹ï¼Œcwd çš„ä½œç”¨ä¸å°±æ˜¯ä»£æ›¿ <code>cd</code> å—ï¼Œä½†ç°åœ¨çš„ç»“æœçœ‹æ¥ <code>yarn --cwd ../ preinstall</code> å¹¶ä¸ç­‰ä»·äº <code>cd ../ &amp;&amp; yarn preinstall</code> ã€‚</p>
<p>è¿™å°±ä¸å¾—ä¸è®©äººç–‘æƒ‘ cwd çš„å®šä½æ–¹å¼äº†ï¼Œåœ¨ç½‘ä¸Šæœå¯»ä¸€ç•ªæ²¡æ‰¾åˆ°ç›¸å…³çš„è®¨è®ºï¼Œé‚£åªèƒ½è‡ªå·±åŠ¨æ‰‹ä¸°è¡£è¶³é£Ÿï¼Œç›´æ¥ä» yarn æºç ä¸­å¯»æ‰¾ç­”æ¡ˆã€‚</p>
<h2 id="åˆ†ææºç "><a href="#åˆ†ææºç " class="headerlink" title="åˆ†ææºç "></a>åˆ†ææºç </h2><p>å‰é¢æˆ‘ä»¬è¯´åˆ°ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ yarn v1.22.11ï¼Œåœ¨ yarn çš„ GitHub ä»“åº“ä¸­å‘ç° v1 ç‰ˆæœ¬çš„æœ€æ–°ç‰ˆæœ¬åœç•™åœ¨ v1.23.0-0ï¼Œé‚£æˆ‘ä»¬å°±ä»è¿™ä¸ªç‰ˆæœ¬çš„æºç æ¥è¿›è¡Œåˆ†æï¼Œé¦–å…ˆå…‹éš†ä»£ç åˆ°æœ¬åœ°ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth=1 https://github.com/yarnpkg/yarn</span><br></pre></td></tr></table></figure>

<p>ç„¶åå®‰è£…ä¾èµ–å¹¶è¿è¡Œèµ·æ¥ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn &amp;&amp; yarn watch</span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶å€™å®ƒå°±ä¼šè‡ªåŠ¨ç›‘å¬ä»£ç ä¿®æ”¹ç„¶åé‡æ–°ç¼–è¯‘ï¼Œæˆ‘ä»¬æŸ¥çœ‹ <code>package.json</code> å‘ç° yarn çš„ bin ä¸»è¦æ˜¯è°ƒç”¨ <code> ./bin/yarn.js</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;bin&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;yarn&quot;</span>: <span class="string">&quot;./bin/yarn.js&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;yarnpkg&quot;</span>: <span class="string">&quot;./bin/yarn.js&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç›´æ¥æ‰§è¡Œ <code>bin/yarn.js</code> çš„æ•ˆæœå°±å¦‚åŒæ‰§è¡Œ <code>yarn</code>ï¼Œè¯•ä¸€ä¸‹æŸ¥çœ‹ç‰ˆæœ¬ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; /Users/4ark/projects/yarn/bin/yarn -v</span><br><span class="line">1.23.0-0</span><br></pre></td></tr></table></figure>

<p>PSï¼šå½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨é¡¹ç›®ç›®å½•ä¸‹ä½¿ç”¨ <code>npm link</code> æŠŠå®ƒæŒ‚è½½åˆ°æœ¬åœ°ä¸­ã€‚</p>
<p>æ¥ä¸‹å°±æ˜¯ä¸€ç•ªè°ƒè¯•ï¼Œç»ˆäºå®šä½åˆ°å¯ä»¥å›ç­”æˆ‘ä»¬ç–‘é—®çš„ä»£ç ï¼Œ<a target="_blank" rel="noopener" href="https://github.dev/yarnpkg/yarn/blob/6db39cf0ff684ce4e7de29669046afb8103fce3d/src/cli/index.js#L37-L51">åœ¨è¿™é‡Œ</a>ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findProjectRoot</span>(<span class="params">base: string</span>): <span class="title">string</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> prev = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">let</span> dir = base;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (fs.existsSync(path.join(dir, constants.NODE_PACKAGE_JSON))) &#123;</span><br><span class="line">      <span class="keyword">return</span> dir;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    prev = dir;</span><br><span class="line">    dir = path.dirname(dir);</span><br><span class="line">  &#125; <span class="keyword">while</span> (dir !== prev);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> base;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cwd = command.shouldRunInCurrentCwd ? commander.cwd : findProjectRoot(commander.cwd);</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ° cwd çš„å®šä½æ–¹å¼æ˜¯ä»å½“å‰ç›®å½•å¯»æ‰¾æ˜¯å¦å­˜åœ¨ <code>package.json</code>ï¼Œè‹¥å­˜åœ¨ï¼Œåˆ™è¿”å›æ­¤ç›®å½•ï¼Œå¦åˆ™å°†ç›®å½•ç»è¿‡ <code>path.dirname</code> å¤„ç†ä¸€éï¼Œç»§ç»­å¯»æ‰¾ï¼Œç›´åˆ°å¯»æ‰¾åˆ°æœ€å¤–å±‚ã€‚</p>
<p>é‚£ä¹ˆè¿™é‡Œæœ€å…³é”®çš„æ˜¯ <code>path.dirname</code> çš„è¿”å›å€¼ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹æ–‡æ¡£å¯¹äºå®ƒçš„æè¿°ï¼š</p>
<blockquote>
<p>The <code>path.dirname()</code> method returns the directory name of a <code>path</code>, similar to the Unix <code>dirname</code> command. Trailing directory separators are ignored,</p>
</blockquote>
<p>å°±æ˜¯è¿”å›ä¸€ä¸ªè·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ï¼Œä½œç”¨ä¸ unix ä¸‹çš„ dirname å‘½ä»¤ä¸€è‡´ï¼Œé€šå¸¸æ˜¯è¿™ä¹ˆä½¿ç”¨çš„ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; dirname /4ark/app/index.js</span><br><span class="line">/4ark/app</span><br><span class="line"></span><br><span class="line">&gt; dirname /4ark/app/packages/index.js</span><br><span class="line">/4ark/app/packages</span><br></pre></td></tr></table></figure>

<p>æ˜¯ä¸æ˜¯ä¼šè‚¤æµ…åœ°è®¤ä¸ºå®ƒçš„ä½œç”¨å°±æ˜¯è¿”å›ä¸€ä¸ªè·¯å¾„çš„ä¸Šä¸€çº§ç›®å½•ï¼Ÿå¦‚æœä¼ å…¥çš„æ˜¯ä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œç¡®å®å¯ä»¥è¿™ä¹ˆè‚¤æµ…åœ°è®¤ä¸ºï¼Œç„¶è€Œå½“ä¼ å…¥çš„æ˜¯ä¸€ä¸ªç›¸å¯¹è·¯å¾„æ—¶ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; dirname ../app/index.js</span><br><span class="line">../app</span><br><span class="line"></span><br><span class="line">&gt; dirname ../../</span><br><span class="line">../</span><br><span class="line"></span><br><span class="line">&gt; dirname ../</span><br><span class="line">é—®: ä¼šè¿”å›ä»€ä¹ˆå‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>

<p>ç­”æ¡ˆæ˜¯ï¼š<code>.</code>ï¼Œä¹Ÿå°±æ˜¯å½“å‰ç›®å½•ã€‚</p>
<p>é‚£è¿™é‡Œå°±èƒ½å›ç­”æˆ‘ä»¬ä¹‹å‰çš„é—®é¢˜ï¼Œä¸ºä»€ä¹ˆåœ¨ <code>node_module/@monorepo/config</code> ä¸­ä½¿ç”¨ <code>yarn --cwd ../ preinstall</code> å´åœ¨å½“å‰ç›®å½•æ‰§è¡Œï¼Œå› ä¸ºå®ƒçš„ä¸Šä¸€çº§ <code>node_modules/@monorepo</code> ä¸å­˜åœ¨ <code>package.json</code>ï¼Œæ‰€ä»¥ç»è¿‡ <code>dirname ../</code> å¤„ç†å cwd çš„æŒ‡å‘å°±æ˜¯å½“å‰ç›®å½•ã€‚</p>
<p>å¦‚æœå¯¹ node.js ä¸­ <code>path.dirname</code> çš„å®ç°æ–¹å¼æ„Ÿå…´è¶£ï¼Œå¯ä»¥çœ‹è¿™é‡Œ <a target="_blank" rel="noopener" href="https://github.com/jinder/path/blob/master/path.js#L538-L554">path.js#L538-L554</a>ã€‚</p>
<h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>æ‘¸æ¸…æ¥šåŸå› åï¼Œé‚£è§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿä¸æ˜¯éš¾äº‹ï¼Œåªè¦æˆ‘ä»¬æŠŠç›¸å¯¹è·¯å¾„æ”¹æˆç»å¯¹è·¯å¾„ï¼Œæ˜¯ä¸æ˜¯å°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜äº†ï¼Ÿ</p>
<p>æ€è€ƒä¸€ä¸‹ï¼Œå…¶å® <code>yarn --cwd ../ preinstall</code>ï¼ŒæŠŠ <code>../</code> æ”¹æˆç»å¯¹è·¯å¾„è¡Œä¸è¡Œå‘¢ï¼Ÿæ¯”å¦‚åœ¨æœ¬æ–‡çš„åœºæ™¯ï¼Œ<code>../</code> å…¶å®å°±æ˜¯é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œé‚£æˆ‘ä»¬å®Œå…¨å¯ä»¥é€šè¿‡åˆ«çš„æ–¹å¼è·å–åˆ°é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œæ¯”å¦‚ åœ¨ git ä¸­ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rev-parse --show-toplevel</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬æŠŠå‘½ä»¤æ”¹æˆè¿™æ ·ï¼Œé—®é¢˜å°±è¿åˆƒè€Œè§£äº†ï¼š</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- yarn --cwd ../ preinstall</span></span><br><span class="line"><span class="addition">+ yarn --cwd $(git rev-parse --show-toplevel) preinstall</span></span><br></pre></td></tr></table></figure>

<p>é‚£å°±ä¸å¾—ä¸æä¸€ä¸‹ï¼Œå…¶å®åœ¨ yarn v2 ä¸­æ–°å¢äº†ä¸€ä¸ª <code>--top-level</code>  å±æ€§ï¼Œå®ƒçš„ä½œç”¨åˆšå¥½å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>å…¶å®æˆ‘ä»¬å†å›è¿‡å¤´æ¥æƒ³ï¼Œåœ¨æœ¬æ–‡çš„ä¾‹å­ä¸­ï¼Œæ ¹æœ¬ä¸éœ€è¦åœ¨ <code>config</code> ç›®å½•ä¸­æ·»åŠ  <code>preinstall</code> è¿™ä¸ªé’©å­ï¼Œå› ä¸ºå®ƒä½œä¸ºå…±äº«åŒ…ï¼Œæ¯æ¬¡ä¿®æ”¹éƒ½å¿…ç„¶è¦åœ¨å…¶å®ƒä½¿ç”¨è¿™ä¸ªåŒ…çš„åœ°æ–¹ï¼Œé‡æ–°å®‰è£…ä¸€æ¬¡ï¼Œæ‰€ä»¥åªè¦ç¡®ä¿è¿™äº›åœ°æ–¹ä¼šæ‰§è¡Œ <code>preinstall</code> å°±å¯ä»¥äº†ï¼Œé‚£ä¹Ÿå°±æ„å‘³ç€ä¸ä¼šå‡ºç°æœ¬æ–‡é‡åˆ°çš„é—®é¢˜ã€‚</p>
<p>ä¸è¿‡ï¼Œå¤šè¸©å‘ä¹Ÿä¸æ˜¯åäº‹ï¼Œåªè¦ææ¸…æ¥šèƒŒåçš„åŸå› ï¼Œé—®é¢˜ä¹Ÿå°±ä¸æ˜¯é—®é¢˜ã€‚</p>
</div>
  <hr class="copy-line" />
  <div class="post-copyright">
    <div class="copy-author">
      <span>ä½œè€… :</span>
      <span
        >4Ark</span
      >
    </div>
    <div class="copy-url">
      <span>åœ°å€ :</span>
      <a href="https://4ark.me/post/yarn-cwd-issue.html">https://4ark.me/post/yarn-cwd-issue.html</a>
    </div>
    <div class="copy-origin">
      <span>æ¥æº :</span>
      <a href="https://4ark.me">https://4ark.me</a>
    </div>
    <div class="copy-license">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ï¼Œè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒã€‚</div>
  </div>
</article>

<div class="blog-post-comments">
  <div id="load-disqus">
    <p onclick="loadDisqus()" style="cursor: pointer; text-align: center">
      ğŸ¥³&nbsp;åŠ è½½ Disqus è¯„è®º
    </p>
  </div>
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments.</noscript>
  </div>
</div>
 


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about">About</a></li>
         
          <li><a href="/archives">Writing</a></li>
         
          <li><a href="/weekly">Weekly</a></li>
         
          <li><a href="/tags">Tags</a></li>
         
          <li><a href="/search">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%81%87%E5%88%B0%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98%E5%91%A2"><span class="toc-number">2.</span> <span class="toc-text">é‡åˆ°ä»€ä¹ˆé—®é¢˜å‘¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E5%8E%9F%E5%9B%A0"><span class="toc-number">3.</span> <span class="toc-text">åˆ†æåŸå› </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E6%BA%90%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text">åˆ†ææºç </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">5.</span> <span class="toc-text">è§£å†³æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AF%AD"><span class="toc-number">6.</span> <span class="toc-text">ç»“è¯­</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://4ark.me/post/yarn-cwd-issue.html"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://4ark.me/post/yarn-cwd-issue.html&text=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://4ark.me/post/yarn-cwd-issue.html&title=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://4ark.me/post/yarn-cwd-issue.html&is_video=false&description=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·&body=Check out this article: https://4ark.me/post/yarn-cwd-issue.html"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://4ark.me/post/yarn-cwd-issue.html&title=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://4ark.me/post/yarn-cwd-issue.html&title=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://4ark.me/post/yarn-cwd-issue.html&title=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://4ark.me/post/yarn-cwd-issue.html&title=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://4ark.me/post/yarn-cwd-issue.html&name=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://4ark.me/post/yarn-cwd-issue.html&t=ä»ä¸€æ¬¡ yarn å‘½ä»¤æ­»å¾ªç¯è¯´èµ·"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="dark-mobile" class="icon"><i class="fa fa-sun" id="dark-btn" aria-hidden="true"></i> Switch</a>
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2024
    4Ark
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about">About</a></li><!--
     --><!--
       --><li><a href="/archives">Writing</a></li><!--
     --><!--
       --><li><a href="/weekly">Weekly</a></li><!--
     --><!--
       --><li><a href="/tags">Tags</a></li><!--
     --><!--
       --><li><a href="/search">Search</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-190615898-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-190615898-1');
    </script>

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<script type="text/javascript">
  function loadDisqus() {
    var disqus_shortname = 'https-4ark-me'

    ;(function () {
      var dsq = document.createElement('script')
      dsq.type = 'text/javascript'
      dsq.async = true
      dsq.src =
        '//' +
        disqus_shortname +
        '.disqus.com/embed.js'
      ;(
        document.getElementsByTagName('head')[0] ||
        document.getElementsByTagName('body')[0]
      ).appendChild(dsq)
    })()

    $('#load-disqus').hide()
  }
</script>

<!-- utterances Comments -->

</body>
</html>
